# Stacked Ablation Challenge

一个基于Canvas的交互式几何形状消融游戏，展示形状重叠的奇偶规则效果。

## 功能特性

### 双模式设计
- **探索模式**：自由创建和操作形状，实验消融效果
- **闯关模式**：网格约束的精确操作模式，支持实时渲染

### 形状操作
- **三种基本形状**：圆形、正方形、三角形
- **多种交互方式**：
  - 鼠标点击创建形状
  - 拖拽移动形状（实时更新）
  - 键盘方向键精确移动
  - 右键旋转形状
  - 滚轮调整形状尺寸
  - 三连击删除形状

### 智能尺寸系统
- **圆形**：直径可在2、4、6、8个网格单位间调整，默认4单位
- **正方形**：边长可在2、4、6、8个网格单位间调整，默认4单位
- **三角形**：保持传统缩放比例系统

### 消融效果
- **奇偶规则**：奇数重叠显示白色，偶数重叠透明
- **实时计算**：动态显示形状重叠的消融区域
- **性能优化**：背景缓存+异或算法，支持大量形状
- **视觉优化**：抗锯齿渲染，流畅的视觉体验

### 闯关模式特色
- **30x30网格系统**：600x600像素画布的精确网格
- **网格吸附**：形状几何中心自动对齐到网格点
- **网格可视化**：清晰的网格线和定位点
- **实时渲染**：移动过程中实时显示消融效果

## 性能优化

- **异或算法**：闯关模式使用背景缓存+异或操作，性能与形状数量无关
- **智能更新**：根据模式自动选择最优渲染策略
- **缓存机制**：避免重复计算，提升响应速度
- **抗锯齿**：高质量图像平滑处理

## 技术实现

- **纯JavaScript**：无依赖的原生实现
- **Canvas 2D**：高性能图形渲染
- **像素级计算**：精确的重叠检测算法
- **事件驱动**：响应式用户交互
- **模块化设计**：清晰的代码结构

## 使用方法

1. **选择模式**：点击顶部的"探索模式"或"闯关模式"按钮
2. **创建形状**：点击形状按钮，然后在画布上点击创建
3. **操作形状**：
   - **移动**：拖拽或使用方向键
   - **旋转**：右键点击形状
   - **缩放**：选中形状后使用滚轮
   - **删除**：对同一形状快速三连击
4. **观察效果**：实时查看形状重叠产生的消融效果

## 项目结构

```
js/
├── core/                   # 核心业务逻辑
│   ├── Config.js          # 配置常量管理
│   ├── Game.js            # 游戏主控制类
│   └── Shape.js           # 形状基础类
│
├── managers/              # 管理器类
│   ├── EventHandler.js   # 事件处理管理器
│   ├── GameManager.js     # 游戏管理器
│   └── Renderer.js        # 渲染管理器
│
├── utils/                 # 工具类
│   ├── AblationCalculator.js  # 消融算法计算器
│   └── GeometryUtils.js   # 几何计算工具
│
├── ui/                    # 用户界面控制
│   └── UIController.js    # UI控制器
│
└── main.js               # 主入口文件
```

- `index.html` - 主页面和UI界面
- `game.js` - 核心游戏逻辑和渲染引擎
- `README.md` - 项目说明文档
- `CHANGES.md` - 版本更新记录